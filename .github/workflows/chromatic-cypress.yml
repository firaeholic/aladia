name: Chromatic Cypress

on:
  pull_request:
    branches:
      - '**'
jobs:
  chromatic:
    name: Run Chromatic
    runs-on: ubuntu-latest

    steps:
        - name: Checkout code
          uses: actions/checkout@v4
          with:
            fetch-depth: 0
            ref: ${{ github.event.pull_request.head.ref }}
  
        - uses: actions/setup-node@v4
          with:
            node-version: 20
  
        - name: Set up Node.js
          uses: actions/setup-node@v3
          with:
              node-version: '20.18.0'
    
        - name: Install dependencies
          run: npm install
  
        - name: Run Chromatic for Cypress
          uses: chromaui/action@latest
          with:
            projectToken: chpt_54541445a4fd0e4
            exitZeroOnChanges: true
            onlyChanged: true
            zip: true
            forceRebuild: true
